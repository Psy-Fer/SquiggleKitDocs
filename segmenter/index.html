<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>segmenter - SquiggleKit Docs</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "segmenter";
    var mkdocs_page_input_path = "segmenter.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> SquiggleKit Docs</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="..">Home</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../files/">Files and folders</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../install/">Installation</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../fast5_fetcher/">fast5_fetcher</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../SquigglePull/">SquigglePull</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../SquigglePlot/">SquigglePlot</a>
	    </li>
          
            <li class="toctree-l1 current">
		
    <a class="current" href="./">segmenter</a>
    <ul class="subnav">
            
    <li class="toctree-l2"><a href="#segmenter">Segmenter</a></li>
    

    <li class="toctree-l2"><a href="#background">Background</a></li>
    

    <li class="toctree-l2"><a href="#getting-started">Getting Started</a></li>
    

    <li class="toctree-l2"><a href="#instructions-for-use">Instructions for use</a></li>
    

    <li class="toctree-l2"><a href="#quick-start">Quick start</a></li>
    

    <li class="toctree-l2"><a href="#full-usage">Full usage</a></li>
    

    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../MotifSeq/">MotifSeq</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../examples/">Examples</a>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">SquiggleKit Docs</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
    
    <li>segmenter</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="segmenter">Segmenter</h1>
<h1 id="background">Background</h1>
<p>Nanopore signal can have larger structurally identifiable regions. These regions can be separated into 3 categories: Stall, homopolymer, regular DNA/cDNA sequence. Identifying the stall at the start of a nanopore read allows for extraction, visualisation, and comparison of the regular sequence. Finding homopolymer sequences can aid in identifying full lenght cDNA reads, or breaking up contatonated reads. Using segmenter in conjunction with MotifSeq allows for simple targeting within the raw signal. Selected regions can then be, for example, used as input to various classical comparison methods, such as Dynamic Time Warping (DTW), or used as training sets for Machine/Deep Learning techniques.</p>
<p>The core algorithm calculates the median of the full read, sets thresholds about the median using a fraction of the standard deviation, and uses a sliding window to find regions of signal which stay inside the threshold region. Error correction and segment merging helps handle the noisy nature of the raw signal data.</p>
<p>This is a demonstration for analysing raw signal data. The algorithm was developed out frustration with the overcomplicated or incompatible methods employed in other time analysis fields, such as sound wave or ECG detection. It is has undergone minimal optimisation, though still gives surprisingly good results.</p>
<p><img alt="Image of full length cDNA showing stall and PolyA tail homopolymer" src="../img/segmenter_fig.jpg" /></p>
<h1 id="getting-started">Getting Started</h1>
<p><strong>Segmenter</strong> takes a flat file list of fast5 paths, a top directory of file paths, or a signal file from <strong>SquigglePull</strong>. It can be set to only detect stalls, or it can detect homopolymers within a distance of the start of a read depending on read structure. Many of the core arguments in the algorithm can be modified with arguments for tuning output.</p>
<h1 id="instructions-for-use">Instructions for use</h1>
<p><strong>Segmenter</strong> has a built visualisation using <code>-v</code>. This is very helpful in tuning the parameters. Default values are a rough estimate for getting some results from most reads.</p>
<h1 id="quick-start">Quick start</h1>
<p><strong>Identify any segments in folder and visualise each one</strong></p>
<p>Use <code>f</code> to full screen a plot, and <code>ctrl+w</code> to close a plot and move to the next one.</p>
<pre><code>python segmenter.py -p ./test/ -v
</code></pre>
<p><strong>Stall identification</strong></p>
<pre><code>python segmenter.py -s signals.tsv.gz -ku -j 100 &gt; signals_stall_segments.tsv
</code></pre>
<h1 id="full-usage">Full usage</h1>
<pre><code class="bash">usage: segmenter.py [-h] [-f F5F | -p F5_PATH | -s SIGNAL] [-n NUM] [-e ERROR]
                    [-c CORRECTOR] [-w WINDOW] [-d SEG_DIST] [-t STD_SCALE]
                    [-v] [-g] [-b GAP_DIST] [-k] [-u] [-l STALL_LEN]
                    [-j STALL_START] [-scale_hi SCALE_HI]
                    [-scale_low SCALE_LOW]

segmenter - script to find obvious regions in squiggle data

optional arguments:
  -h, --help            show this help message and exit
  -f F5F, --f5f F5F     File list of fast5 paths
  -p F5_PATH, --f5_path F5_PATH
                        Fast5 top dir
  -s SIGNAL, --signal SIGNAL
                        Extracted signal file from squigglePull
  -n NUM, --Num NUM     Section of signal to look at - default 0=all
  -e ERROR, --error ERROR
                        Allowable error in segment algorithm
  -c CORRECTOR, --corrector CORRECTOR
                        Window size for increasing total error correction -
                        better long segment detection
  -w WINDOW, --window WINDOW
                        Minimum segment window size to be detected
  -d SEG_DIST, --seg_dist SEG_DIST
                        Maximum distance between 2 segments to be merged into
                        1
  -t STD_SCALE, --std_scale STD_SCALE
                        Scale factor of STDev about median
  -v, --view            view each output
  -g, --gap             Turn on gap distance for stall to polyTAil
  -b GAP_DIST, --gap_dist GAP_DIST
                        Maximum distance between stall and polyTAil segment -
                        for 10X/dRNA
  -k, --stall           Turn on stall detection - must be present
  -u, --test            Run Tests
  -l STALL_LEN, --stall_len STALL_LEN
                        Minimum percentage of minimum window segment for
                        initial stall segment
  -j STALL_START, --stall_start STALL_START
                        Maximum distance for start of stall segment to be
                        detected
  -scale_hi SCALE_HI, --scale_hi SCALE_HI
                        Upper limit for signal outlier scaling
  -scale_low SCALE_LOW, --scale_low SCALE_LOW
                        Lower limit for signal outlier scaling
</code></pre>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../MotifSeq/" class="btn btn-neutral float-right" title="MotifSeq">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../SquigglePlot/" class="btn btn-neutral" title="SquigglePlot"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../SquigglePlot/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../MotifSeq/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>

</body>
</html>
